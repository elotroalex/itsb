{"version":3,"sources":["libs/d3.slider.js"],"names":["root","factory","define","amd","exports","process","browser","require","module","d3","slider","this","value","scale","axisScale","handle1","divRange","sliderLength","min","max","step","animate","orientation","axis","margin","active","snap","dispatch","formatPercent","format","tickFormat","handle2","selection","each","linear","domain","div","select","classed","drag","behavior","on","slideend","event","toType","length","append","attr","stopPropagation","call","pos","Math","offsetX","layerX","moveHandle","invert","stepValue","nearestTick","style","onDragHorizontal","width","parseFloat","parseInt","offsetY","layerY","onDragVertical","top","sourceEvent","target","id","x","y","dom","svg","ticks","round","orient","copy","range","rangePoints","g","height","createAxis","newValue","currentValue","oldPos","newPos","position","slide","transition","styleTween","interpolate","duration","val","alignValue","valModStep","abs","dist","map","d","i","index","r","rangeExtent","v","toString","match","toLowerCase","_","arguments","rebind"],"mappings":"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","file":"../../libs/d3.slider.min.js","sourcesContent":["/*\r\n    D3.js Slider\r\n    Inspired by jQuery UI Slider\r\n    Copyright (c) 2013, Bjorn Sandvik - http://blog.thematicmapping.org\r\n    BSD license: http://opensource.org/licenses/BSD-3-Clause\r\n*/\r\n(function (root, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    // AMD. Register as an anonymous module.\r\n    define(['d3'], factory);\r\n  } else if (typeof exports === 'object') {\r\n    if (process.browser) {\r\n      // Browserify. Import css too using cssify.\r\n      require('./d3.slider.css');\r\n    }\r\n    // Node. Does not work with strict CommonJS, but\r\n    // only CommonJS-like environments that support module.exports,\r\n    // like Node.\r\n    module.exports = factory(require('d3'));\r\n  } else {\r\n    // Browser globals (root is window)\r\n    root.d3.slider = factory(root.d3);\r\n  }\r\n}(this, function (d3) {\r\nreturn function module() {\r\n  \"use strict\";\r\n\r\n  // Public variables width default settings\r\n  var min = 0,\r\n      max = 100,\r\n      step = 0.01,\r\n      animate = true,\r\n      orientation = \"horizontal\",\r\n      axis = false,\r\n      margin = 50,\r\n      value,\r\n      active = 1,\r\n      snap = false,\r\n      scale;\r\n\r\n  // Private variables\r\n  var axisScale,\r\n      dispatch = d3.dispatch(\"slide\", \"slideend\"),\r\n      formatPercent = d3.format(\".2%\"),\r\n      tickFormat = d3.format(\".0\"),\r\n      handle1,\r\n      handle2 = null,\r\n      divRange,\r\n      sliderLength;\r\n\r\n  function slider(selection) {\r\n    selection.each(function() {\r\n\r\n      // Create scale if not defined by user\r\n      if (!scale) {\r\n        scale = d3.scale.linear().domain([min, max]);\r\n      }\r\n\r\n      // Start value\r\n      value = value || scale.domain()[0];\r\n\r\n      // DIV container\r\n      var div = d3.select(this).classed(\"d3-slider d3-slider-\" + orientation, true);\r\n      \r\n      var drag = d3.behavior.drag();\r\n      drag.on('dragend', function () {\r\n        dispatch.slideend(d3.event, value);\r\n      })\r\n\r\n      // Slider handle\r\n      //if range slider, create two\r\n      // var divRange;\r\n\r\n      if (toType(value) == \"array\" && value.length == 2) {\r\n        handle1 = div.append(\"a\")\r\n          .classed(\"d3-slider-handle\", true)\r\n          .attr(\"xlink:href\", \"#\")\r\n          .attr('id', \"handle-one\")\r\n          .on(\"click\", stopPropagation)\r\n          .call(drag);\r\n        handle2 = div.append(\"a\")\r\n          .classed(\"d3-slider-handle\", true)\r\n          .attr('id', \"handle-two\")\r\n          .attr(\"xlink:href\", \"#\")\r\n          .on(\"click\", stopPropagation)\r\n          .call(drag);\r\n      } else {\r\n        handle1 = div.append(\"a\")\r\n          .classed(\"d3-slider-handle\", true)\r\n          .attr(\"xlink:href\", \"#\")\r\n          .attr('id', \"handle-one\")\r\n          .on(\"click\", stopPropagation)\r\n          .call(drag);\r\n      }\r\n      \r\n      // Horizontal slider\r\n      if (orientation === \"horizontal\") {\r\n\r\n        div.on(\"click\", onClickHorizontal);\r\n        \r\n        if (toType(value) == \"array\" && value.length == 2) {\r\n          divRange = d3.select(this).append('div').classed(\"d3-slider-range\", true);\r\n\r\n          handle1.style(\"left\", formatPercent(scale(value[ 0 ])));\r\n          divRange.style(\"left\", formatPercent(scale(value[ 0 ])));\r\n          drag.on(\"drag\", onDragHorizontal);\r\n\r\n          var width = 100 - parseFloat(formatPercent(scale(value[ 1 ])));\r\n          handle2.style(\"left\", formatPercent(scale(value[ 1 ])));\r\n          divRange.style(\"right\", width+\"%\");\r\n          drag.on(\"drag\", onDragHorizontal);\r\n\r\n        } else {\r\n          handle1.style(\"left\", formatPercent(scale(value)));\r\n          drag.on(\"drag\", onDragHorizontal);\r\n        }\r\n        \r\n        sliderLength = parseInt(div.style(\"width\"), 10);\r\n\r\n      } else { // Vertical\r\n\r\n        div.on(\"click\", onClickVertical);\r\n        drag.on(\"drag\", onDragVertical);\r\n        if (toType(value) == \"array\" && value.length == 2) {\r\n          divRange = d3.select(this).append('div').classed(\"d3-slider-range-vertical\", true);\r\n\r\n          handle1.style(\"bottom\", formatPercent(scale(value[ 0 ])));\r\n          divRange.style(\"bottom\", formatPercent(scale(value[ 0 ])));\r\n          drag.on(\"drag\", onDragVertical);\r\n\r\n          var top = 100 - parseFloat(formatPercent(scale(value[ 1 ])));\r\n          handle2.style(\"bottom\", formatPercent(scale(value[ 1 ])));\r\n          divRange.style(\"top\", top+\"%\");\r\n          drag.on(\"drag\", onDragVertical);\r\n\r\n        } else {\r\n          handle1.style(\"bottom\", formatPercent(scale(value)));\r\n          drag.on(\"drag\", onDragVertical);\r\n        }\r\n        \r\n        sliderLength = parseInt(div.style(\"height\"), 10);\r\n\r\n      }\r\n      \r\n      if (axis) {\r\n        createAxis(div);\r\n      }\r\n\r\n\r\n      function createAxis(dom) {\r\n\r\n        // Create axis if not defined by user\r\n        if (typeof axis === \"boolean\") {\r\n\r\n          axis = d3.svg.axis()\r\n              .ticks(Math.round(sliderLength / 100))\r\n              .tickFormat(tickFormat)\r\n              .orient((orientation === \"horizontal\") ? \"bottom\" :  \"right\");\r\n\r\n        }\r\n\r\n        // Copy slider scale to move from percentages to pixels\r\n        axisScale = scale.ticks ? scale.copy().range([0, sliderLength]) : scale.copy().rangePoints([0, sliderLength], 0.5);\r\n          axis.scale(axisScale);\r\n\r\n          // Create SVG axis container\r\n        var svg = dom.append(\"svg\")\r\n            .classed(\"d3-slider-axis d3-slider-axis-\" + axis.orient(), true)\r\n            .on(\"click\", stopPropagation);\r\n\r\n        var g = svg.append(\"g\");\r\n\r\n        // Horizontal axis\r\n        if (orientation === \"horizontal\") {\r\n\r\n          svg.style(\"margin-left\", -margin + \"px\");\r\n\r\n          svg.attr({\r\n            width: sliderLength + margin * 2,\r\n            height: margin\r\n          });\r\n\r\n          if (axis.orient() === \"top\") {\r\n            svg.style(\"top\", -margin + \"px\");\r\n            g.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\");\r\n          } else { // bottom\r\n            g.attr(\"transform\", \"translate(\" + margin + \",0)\");\r\n          }\r\n\r\n        } else { // Vertical\r\n\r\n          svg.style(\"top\", -margin + \"px\");\r\n\r\n          svg.attr({\r\n            width: margin,\r\n            height: sliderLength + margin * 2\r\n          });\r\n\r\n          if (axis.orient() === \"left\") {\r\n            svg.style(\"left\", -margin + \"px\");\r\n            g.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\");\r\n          } else { // right          \r\n            g.attr(\"transform\", \"translate(\" + 0 + \",\" + margin + \")\");\r\n          }\r\n\r\n        }\r\n\r\n        g.call(axis);\r\n\r\n      }\r\n\r\n      function onClickHorizontal() {\r\n        if (toType(value) != \"array\") {\r\n          var pos = Math.max(0, Math.min(sliderLength, d3.event.offsetX || d3.event.layerX));\r\n          moveHandle(scale.invert ? \r\n                      stepValue(scale.invert(pos / sliderLength))\r\n                    : nearestTick(pos / sliderLength));\r\n        }\r\n      }\r\n\r\n      function onClickVertical() {\r\n        if (toType(value) != \"array\") {\r\n          var pos = sliderLength - Math.max(0, Math.min(sliderLength, d3.event.offsetY || d3.event.layerY));\r\n          moveHandle(scale.invert ? \r\n                      stepValue(scale.invert(pos / sliderLength))\r\n                    : nearestTick(pos / sliderLength));\r\n        }\r\n      }\r\n\r\n      function onDragHorizontal() {\r\n        if ( d3.event.sourceEvent.target.id === \"handle-one\") {\r\n          active = 1;\r\n        } else if ( d3.event.sourceEvent.target.id == \"handle-two\" ) {\r\n          active = 2;\r\n        }\r\n        var pos = Math.max(0, Math.min(sliderLength, d3.event.x));\r\n        moveHandle(scale.invert ? \r\n                    stepValue(scale.invert(pos / sliderLength))\r\n                  : nearestTick(pos / sliderLength));\r\n      }\r\n\r\n      function onDragVertical() {\r\n        if ( d3.event.sourceEvent.target.id === \"handle-one\") {\r\n          active = 1;\r\n        } else if ( d3.event.sourceEvent.target.id == \"handle-two\" ) {\r\n          active = 2;\r\n        }\r\n        var pos = sliderLength - Math.max(0, Math.min(sliderLength, d3.event.y))\r\n        moveHandle(scale.invert ? \r\n                    stepValue(scale.invert(pos / sliderLength))\r\n                  : nearestTick(pos / sliderLength));\r\n      }\r\n\r\n      function stopPropagation() {\r\n        d3.event.stopPropagation();\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  // Move slider handle on click/drag\r\n  function moveHandle(newValue) {\r\n    var currentValue = toType(value) == \"array\"  && value.length == 2 ? value[active - 1]: value,\r\n        oldPos = formatPercent(scale(stepValue(currentValue))),\r\n        newPos = formatPercent(scale(stepValue(newValue))),\r\n        position = (orientation === \"horizontal\") ? \"left\" : \"bottom\";\r\n    if (oldPos !== newPos) {\r\n\r\n      if (toType(value) == \"array\" && value.length == 2) {\r\n        value[ active - 1 ] = newValue;\r\n        if (d3.event) {\r\n          dispatch.slide(d3.event, value );\r\n        };\r\n      } else {\r\n        if (d3.event) {\r\n          dispatch.slide(d3.event.sourceEvent || d3.event, value = newValue);\r\n        };\r\n      }\r\n\r\n      if ( value[ 0 ] >= value[ 1 ] ) return;\r\n      if ( active === 1 ) {\r\n        if (toType(value) == \"array\" && value.length == 2) {\r\n          (position === \"left\") ? divRange.style(\"left\", newPos) : divRange.style(\"bottom\", newPos);\r\n        }\r\n\r\n        if (animate) {\r\n          handle1.transition()\r\n              .styleTween(position, function() { return d3.interpolate(oldPos, newPos); })\r\n              .duration((typeof animate === \"number\") ? animate : 250);\r\n        } else {\r\n          handle1.style(position, newPos);\r\n        }\r\n      } else {\r\n        \r\n        var width = 100 - parseFloat(newPos);\r\n        var top = 100 - parseFloat(newPos);\r\n\r\n        (position === \"left\") ? divRange.style(\"right\", width + \"%\") : divRange.style(\"top\", top + \"%\");\r\n        \r\n        if (animate) {\r\n          handle2.transition()\r\n              .styleTween(position, function() { return d3.interpolate(oldPos, newPos); })\r\n              .duration((typeof animate === \"number\") ? animate : 250);\r\n        } else {\r\n          handle2.style(position, newPos);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Calculate nearest step value\r\n  function stepValue(val) {\r\n\r\n    if (val === scale.domain()[0] || val === scale.domain()[1]) {\r\n      return val;\r\n    }\r\n\r\n    var alignValue = val;\r\n    if (snap) {\r\n      alignValue = nearestTick(scale(val));\r\n    } else{\r\n      var valModStep = (val - scale.domain()[0]) % step;\r\n      alignValue = val - valModStep;\r\n\r\n      if (Math.abs(valModStep) * 2 >= step) {\r\n        alignValue += (valModStep > 0) ? step : -step;\r\n      }\r\n    };\r\n\r\n    return alignValue;\r\n\r\n  }\r\n\r\n  // Find the nearest tick\r\n  function nearestTick(pos) {\r\n    var ticks = scale.ticks ? scale.ticks() : scale.domain();\r\n    var dist = ticks.map(function(d) {return pos - scale(d);});\r\n    var i = -1,\r\n        index = 0,\r\n        r = scale.ticks ? scale.range()[1] : scale.rangeExtent()[1];\r\n    do {\r\n        i++;\r\n        if (Math.abs(dist[i]) < r) {\r\n          r = Math.abs(dist[i]);\r\n          index = i;\r\n        };\r\n    } while (dist[i] > 0 && i < dist.length - 1);\r\n\r\n    return ticks[index];\r\n  };\r\n\r\n  // Return the type of an object\r\n  function toType(v) {\r\n    return ({}).toString.call(v).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\r\n  };\r\n\r\n  // Getter/setter functions\r\n  slider.min = function(_) {\r\n    if (!arguments.length) return min;\r\n    min = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.max = function(_) {\r\n    if (!arguments.length) return max;\r\n    max = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.step = function(_) {\r\n    if (!arguments.length) return step;\r\n    step = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.animate = function(_) {\r\n    if (!arguments.length) return animate;\r\n    animate = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.orientation = function(_) {\r\n    if (!arguments.length) return orientation;\r\n    orientation = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.axis = function(_) {\r\n    if (!arguments.length) return axis;\r\n    axis = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.margin = function(_) {\r\n    if (!arguments.length) return margin;\r\n    margin = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.value = function(_) {\r\n    if (!arguments.length) return value;\r\n    if (value) {\r\n      moveHandle(stepValue(_));\r\n    };\r\n    value = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.snap = function(_) {\r\n    if (!arguments.length) return snap;\r\n    snap = _;\r\n    return slider;\r\n  };\r\n\r\n  slider.scale = function(_) {\r\n    if (!arguments.length) return scale;\r\n    scale = _;\r\n    return slider;\r\n  };\r\n\r\n  d3.rebind(slider, dispatch, \"on\");\r\n\r\n  return slider;\r\n\r\n}\r\n}));\r\n"]}